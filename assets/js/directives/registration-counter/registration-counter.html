<div class="registration-counter">
  <formula-datasource formulas="ctrl.formulas" categories="ctrl.categories"></formula-datasource>
  <div class="registration-counter__panel">
    <div
      class="registration-counter__box panel panel-default"
      ng-repeat="formula in ctrl.formulas | filter:{category:'young'}"
      id="panel-{{::formula.id}}"
    >
      <div class="panel-heading">
        <span title="{{::formula.label}}">{{::formula.id}}</span>
      </div>
      <div class="panel-body">
        <div class="progress">
          <span class="badge">{{(formula.counter + ctrl.counters[formula.id])}} / {{::formula.limit}}</span>
          <div
            class="progress-bar progress-bar-success"
            ng-class="{'progress-bar-warning': (formula.counter + ctrl.counters[formula.id]) / formula.limit > 0.5,
                       'progress-bar-danger': formula.limit == 0 || (formula.counter + ctrl.counters[formula.id]) / formula.limit > 0.8}"
            role="progressbar"
            aria-valuenow="{{(formula.counter + ctrl.counters[formula.id])}}"
            aria-valuemin="0"
            aria-valuemax="{{::formula.limit}}"
            style="width: {{formula.limit ? (formula.counter + ctrl.counters[formula.id]) / formula.limit * 100 : 100}}%"
          ></div>
        </div>
      </div>
    </div>
    <div class="registration-counter__box registration-counter__box--total panel panel-default">
      <div class="panel-heading">
        <span title="Total jeunes">Total J</span>
      </div>
      <div class="panel-body">
        <div class="progress">
          <span class="badge">{{(ctrl.categories.young.counter + ctrl.counters.young)}} / {{::ctrl.categories.young.limit}}</span>
          <div
            class="progress-bar"
            role="progressbar"
            aria-valuenow="{{(ctrl.categories.young.counter + ctrl.counters.young)}}"
            aria-valuemin="0"
            aria-valuemax="{{::ctrl.categories.young.limit}}"
            style="width: {{(ctrl.categories.young.counter + ctrl.counters.young) / ctrl.categories.young.limit * 100}}%"
          ></div>
        </div>
      </div>
    </div>
  </div>

  <div class="registration-counter__panel">
    <div
      class="registration-counter__box panel panel-default"
      ng-repeat="formula in ctrl.formulas | filter:{category:'adult'}"
      id="panel-{{::formula.id}}"
    >
      <div class="panel-heading">
        <span title="{{::formula.label}}">{{::formula.id}}</span>
      </div>
      <div class="panel-body">
        <div class="progress">
          <span class="badge">{{(formula.counter + ctrl.counters[formula.id])}} / {{::formula.limit}}</span>
          <div
            class="progress-bar progress-bar-success"
            ng-class="{'progress-bar-warning': (formula.counter + ctrl.counters[formula.id]) / formula.limit > 0.5,
                       'progress-bar-danger': formula.limit == 0 || (formula.counter + ctrl.counters[formula.id]) / formula.limit > 0.8}"
            role="progressbar"
            aria-valuenow="{{(formula.counter + ctrl.counters[formula.id])}}"
            aria-valuemin="0"
            aria-valuemax="{{::formula.limit}}"
            style="width: {{formula.limit ? (formula.counter + ctrl.counters[formula.id]) / formula.limit * 100 : 100}}%"
          ></div>
        </div>
      </div>
    </div>
    <div class="registration-counter__box registration-counter__box--total panel panel-default">
      <div class="panel-heading">
        <span title="Total adultes">Total A</span>
      </div>
      <div class="panel-body">
        <div class="progress">
          <span class="badge">{{(ctrl.categories.adult.counter + ctrl.counters.adult)}} / {{::ctrl.categories.adult.limit}}</span>
          <div
            class="progress-bar"
            role="progressbar"
            aria-valuenow="{{(ctrl.categories.adult.counter + ctrl.counters.adult)}}"
            aria-valuemin="0"
            aria-valuemax="{{::ctrl.categories.adult.limit}}"
            style="width: {{(ctrl.categories.adult.counter + ctrl.counters.adult) / ctrl.categories.adult.limit * 100}}%"
          ></div>
        </div>
      </div>
    </div>
  </div>
</div>
